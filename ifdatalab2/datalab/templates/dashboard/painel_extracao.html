{% extends "dashboard/painel.html" %}
{% load static %}

{% block painel_conteudo %}

<h1 class="text-2xl font-semibold mb-6">
  Extração de Produtividade (Lattes)
</h1>

{% for item in grupos %}
  <div class="mb-8 border rounded-lg p-4 bg-white shadow-sm">
    
    <!-- Nome do grupo -->
    <h2 class="text-lg font-semibold mb-3 text-green-700">
      {{ item.grupo.nome }}
    </h2>

    {% if item.pesquisadores %}
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
        
        {% for p in item.pesquisadores %}
          <div class="rounded-md p-3 bg-gray-50 flex flex-col justify-between border border-gray-200">
            <div>
              <p class="font-medium text-gray-800">
                {{ p.nome_completo }}
              </p>
              <p class="text-sm text-gray-500">
                Lattes: {{ p.idlattes|default:"—" }}
              </p>
            </div>

            <form
              method="post"
              action="{% url 'extracao:executar_extracao' p.id %}"
              class="mt-3"
            >
              {% csrf_token %}
              <button
                type="submit"
                class="w-full bg-green-600 hover:bg-green-700 text-white text-sm font-medium py-1.5 rounded transition"
              >
                Extrair produtividade
              </button>
            </form>
          </div>
        {% endfor %}

      </div>
    {% else %}
      <p class="text-gray-500 text-sm">
        Nenhum pesquisador neste grupo.
      </p>
    {% endif %}
  </div>

{% empty %}
  <p class="text-gray-500">
    Você não gerencia nenhum grupo de pesquisa.
  </p>
{% endfor %}

{% endblock %}
